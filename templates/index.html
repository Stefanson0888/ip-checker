<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>IP Checker — Дізнай свою IP-адресу та місцезнаходження</title>

  <meta name="description" content="Миттєво дізнайся свою IP-адресу, геолокацію, провайдера, браузер і більше. Швидко. Без реклами.">
  <meta name="keywords" content="IP, IP Checker, IP адреса, геолокація, провайдер, whois, ip lookup">
  <meta name="author" content="IP Checker">

  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://ip-checker-vlez.onrender.com/" />
  <meta property="og:title" content="IP Checker — Дізнай свою IP-адресу" />
  <meta property="og:description" content="Швидко дізнайся IP, місцезнаходження та дані браузера." />
  <meta property="og:image" content="https://ip-checker-vlez.onrender.com/static/img/og-image.png" />

  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="IP Checker — Швидке визначення IP" />
  <meta name="twitter:description" content="Твоя IP-адреса, місто, провайдер та ще багато — миттєво!" />
  <meta name="twitter:image" content="https://ip-checker-vlez.onrender.com/static/img/og-image.png" />

  <link rel="icon" type="image/png" href="{{ url_for('static', path='favicon.png') }}" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" />

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 30px auto;
      max-width: 1200px;
      padding: 0 15px;
    }

    h1 {
      font-size: 28px;
      margin-bottom: 20px;
    }

    .container {
      display: flex;
      flex-wrap: wrap;
      gap: 40px;
    }

    .info-block {
      flex: 2;
      min-width: 300px;
    }

    .map-block {
      width: 100%;
      height: 400px;
      position: relative;
    }

    #map {
      width: 100%;
      height: 100%;
      border-radius: 10px;
      margin-bottom: 20px;
    }

    .flag {
      margin-top: 10px;
    }

    .flag img {
      width: 100px;
      height: auto;
    }

    .toggle-button {
      margin-top: 20px;
      padding: 8px 16px;
      font-size: 14px;
      background-color: #f0f0f0;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    .toggle-button:hover {
      background-color: #e0e0e0;
    }

    .details {
      overflow: hidden;
      max-height: 0;
      transition: max-height 0.5s ease;
    }

    .details.open {
      max-height: 1000px;
      margin-top: 20px;
    }

    .right-block {
      flex: 1.2;
      display: flex;
      flex-direction: column;
      gap: 20px;
      min-width: 300px;
    }

    .ad-column a img {
      width: 100%;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      display: block;
    }

    @media (max-width: 768px) {
      .container {
        flex-direction: column;
      }

      .right-block {
        flex-direction: column;
        gap: 30px;
      }

      .map-block,
      .ad-column {
        width: 100%;
      }
    }
  </style>
</head>

<body>
  <h1>Твоя IP-адреса: {{ ip }}</h1>

  <div class="container">
    <div class="info-block">
      <p><strong>Місто:</strong> {{ city }}</p>
      <p><strong>Регіон:</strong> {{ region }}</p>
      <p><strong>Країна:</strong> {{ country }}</p>
      <p><strong>Тип:</strong> {{ type }}</p>
      <p><strong>Провайдер (ISP):</strong> {{ isp }}</p>
      <p><strong>Організація (ASN):</strong> {{ asn }}</p>
      <p><strong>Домен:</strong> {{ hostname }}</p>

      {% if flag_url %}
      <div class="flag" aria-label="Прапор країни">
        <img src="{{ flag_url }}" alt="Прапор {{ country }}" loading="lazy" />
      </div>
      {% endif %}

      <button class="toggle-button" id="details-toggle-button" onclick="toggleDetails()">Показати додаткову інформацію</button>

      <div id="additional-info" class="details">
        <p><strong>Часовий пояс:</strong> {{ timezone }}</p>
        <p><strong>Поштовий індекс:</strong> {{ postal }}</p>
        <p><strong>Код країни:</strong> {{ calling_code }}</p>
        <p><strong>Мова:</strong> {{ language }}</p>
        <p><strong>Валюта:</strong> {{ currency }}</p>
        <p><strong>Браузер:</strong> {{ browser }}</p>
        <p><strong>ОС:</strong> {{ os }}</p>
        <p><strong>Проксі:</strong> {{ is_proxy }}</p>
        <p><strong>VPN:</strong> {{ is_vpn }}</p>
        <p><strong>Tor:</strong> {{ is_tor }}</p>
        <p><strong>User-Agent:</strong> {{ user_agent }}</p>
      </div>
    </div>

    <div class="right-block">
      {% if latitude and longitude %}
      <div class="map-block">
        <button class="toggle-button" id="map-toggle-button" onclick="toggleMap()">Показати карту</button>
        <div id="map" style="display: none;"></div>
      </div>
      {% endif %}

      <div class="ad-column">
        <a href="https://example1.com" target="_blank" rel="noopener">
          <img src="{{ url_for('static', path='ads/banner1.png') }}" alt="Реклама 1" />
        </a>
        <a href="https://example2.com" target="_blank" rel="noopener">
          <img src="{{ url_for('static', path='ads/banner2.png') }}" alt="Реклама 2" />
        </a>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
  <script>
    let mapInitialized = false;
    let mapVisible = false;
    let mapInstance = null;

    function toggleDetails() {
      const details = document.getElementById("additional-info");
      const button = document.getElementById("details-toggle-button");
      const isOpen = details.classList.contains("open");

      if (isOpen) {
        details.classList.remove("open");
        button.textContent = "Показати додаткову інформацію";
      } else {
        details.classList.add("open");
        button.textContent = "Сховати додаткову інформацію";
      }
    }

    function toggleMap() {
      const mapContainer = document.getElementById("map");
      const button = document.getElementById("map-toggle-button");

      if (!mapInitialized) {
        mapInstance = L.map('map').setView([{{ latitude }}, {{ longitude }}], 10);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
          attribution: '© OpenStreetMap contributors'
        }).addTo(mapInstance);
        L.marker([{{ latitude }}, {{ longitude }}]).addTo(mapInstance)
          .bindPopup("Ти тут!")
          .openPopup();
        mapInitialized = true;
      }

      mapVisible = !mapVisible;
      mapContainer.style.display = mapVisible ? "block" : "none";
      button.textContent = mapVisible ? "Сховати карту" : "Показати карту";

      if (mapVisible) {
        mapInstance.invalidateSize();
      }
    }
  </script>
</body>
</html>
